\documentclass[12pt,a4paper,dvipdfmx]{jsarticle}

\input{include/package.tex}
\input{include/myminted.tex}

\title{\LaTeX のtemplate}
\author{高名 典雅}
\date{\today}

\begin{document}
\newcounter{listings}

\include{titlepage}

\section{実装内容と使い方}
今回は，PEとELFの両方に対応したバイナリ解析ツールを開発した．
作成したプログラムはRust製で以下の機能を持っている．
\begin{itemize}
    \item[-h] ヘルプの表示
    \item[-e] ヘッダ情報の表示
    \item[-s] セクションヘッダの表示
    \item[-d] セクションのダンプ
    \item[-p] セグメントヘッダの表示（ELFのみ）
    \item[-a] ヘッダ情報とセクションヘッダの（とセグメントヘッダの）表示
\end{itemize}

これらは対象となるバイナリファイルのマジックを読むことで自動的にファイルを判別している．
そのためファイルの仕様を指定するオプションは存在しない．
項目の最初に示したのがオプションで，例えばヘッダ情報を確認したければ-eオプションを渡して実行する．
\begin{quote}
\$ target/debug/readbin \\
error: The following required arguments were not provided: \\
    $<$filename$>$ \\
 \\
USAGE: \\
    readbin [OPTIONS] $<$filename$>$ \\
 \\
For more information try --help \\
 \\
\$ target/debug/readbin -e ./target\_bin \\
================ elf header ================ \\
magic:	7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 \\
class:		1 \\
endian:		1 \\
version:	1 \\
os\_abi:		0 \\
os\_abi\_ver:	0 \\
e\_type:		ET\_EXEC \\
e\_machine:	243 \\
e\_version:	0x1 \\
e\_entry:	0x10086 \\
e\_phoff:	52 (bytes into file) \\
e\_shoff:	15928 (bytes into file) \\
e\_flags:	0x1 \\
e\_ehsize:	52 (bytes) \\
e\_phentsize:	32 (bytes) \\
e\_phnum:	2 \\
e\_shentsize:	40 (bytes) \\
e\_shnum:	15 \\
e\_shstrndx:	14 \\
 \\
 \\
\$ target/debug/readbin -e ./target\_pe.exe \\
================ msdos header ================ \\
e\_magic:	0x5a4d \\
e\_cblp:		0x90 \\
e\_cp:		0x3 \\
e\_crlc:		0x0 \\
e\_cparhdr:	4 \\
e\_minalloc:	0x0 \\
e\_maxalloc:	0xffff \\
e\_ss:		0 \\
e\_sp:		184 \\
e\_csum:		0 \\
e\_ip:		0 \\
e\_cs:		0 \\
e\_lfarlc:	64 \\
e\_ovno:		0 \\
e\_res:		[0, 0, 0, 0] \\
e\_oemid:	0 \\
e\_oeminfo:	0 \\
e\_res2:		[0, 0, 0, 0, 0, 0, 0, 0, 0, 0] \\
e\_lfanew:	0x80 \\
\end{quote}

全てのヘッダ情報が見たい場合は-aオプションを渡す．
\begin{quote}
\$ target/debug/readbin -a ./target\_elf \\
================ elf header ================ \\
magic:	7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 \\
class:		1 \\
endian:		1 \\
version:	1 \\
os\_abi:		0 \\
os\_abi\_ver:	0 \\
e\_type:		ET\_EXEC \\
e\_machine:	243 \\
e\_version:	0x1 \\
e\_entry:	0x10086 \\
e\_phoff:	52 (bytes into file) \\
e\_shoff:	15928 (bytes into file) \\
e\_flags:	0x1 \\
e\_ehsize:	52 (bytes) \\
e\_phentsize:	32 (bytes) \\
e\_phnum:	2 \\
e\_shentsize:	40 (bytes) \\
e\_shnum:	15 \\
e\_shstrndx:	14 \\
 \\
 \\
 \\
============== program header 1============== \\
p\_type:		PT\_LOAD \\
p\_offset:	0x0 \\
p\_vaddr:	0x10000 \\
p\_paddr:	0x10000 \\
p\_filesz:	0x246e \\
p\_memsz:	0x246e \\
p\_flags:	5 \\
p\_align:	0x1000 \\
============== program header 2============== \\
p\_type:		PT\_LOAD \\
p\_offset:	0x2470 \\
p\_vaddr:	0x13470 \\
p\_paddr:	0x13470 \\
p\_filesz:	0x854 \\
p\_memsz:	0x8ac \\
p\_flags:	6 \\
p\_align:	0x1000 \\
 \\
 \\
 \\
============== section header 1============== \\
sh\_name:	 \\
sh\_type:	SHT\_NULL \\
sh\_flags:	0 \\
sh\_addr:	0x0 \\
sh\_offset:	0x0 \\
sh\_size:	0 \\
sh\_link:	0 \\
sh\_info:	0 \\
sh\_addralign:	0 \\
sh\_entsize:	0 \\
 \\
/* 中略 */ \\
 \\
============== section header 15============== \\
sh\_name:	.shstrtab \\
sh\_type:	SHT\_STRTAB \\
sh\_flags:	0 \\
sh\_addr:	0x0 \\
sh\_offset:	0x3dba \\
sh\_size:	126 \\
sh\_link:	0 \\
sh\_info:	0 \\
sh\_addralign:	1 \\
sh\_entsize:	0 \\
\$ target/debug/readbin -a ./target\_pe.exe \\
================ msdos header ================ \\
e\_magic:	0x5a4d \\
e\_cblp:		0x90 \\
e\_cp:		0x3 \\
e\_crlc:		0x0 \\
e\_cparhdr:	4 \\
e\_minalloc:	0x0 \\
e\_maxalloc:	0xffff \\
e\_ss:		0 \\
e\_sp:		184 \\
e\_csum:		0 \\
e\_ip:		0 \\
e\_cs:		0 \\
e\_lfarlc:	64 \\
e\_ovno:		0 \\
e\_res:		[0, 0, 0, 0] \\
e\_oemid:	0 \\
e\_oeminfo:	0 \\
e\_res2:		[0, 0, 0, 0, 0, 0, 0, 0, 0, 0] \\
e\_lfanew:	0x80 \\
 \\
=== NtHeader === \\
signature: 0x4550 \\
--- FileHeader --- \\
machine:	0x8664 \\
number\_of\_sections:	0x14 \\
time\_date\_stamp:	0x63525048 \\
pointer\_to\_symtab:	0x3fc00 \\
number\_of\_symbols:	0x793 \\
size\_of\_optional\_header:	0xf0 \\
characteristics:	0x26 \\
--- OptionalHeader --- \\
magic:	0x20b \\
major\_linker\_version:	0x2 \\
minor\_linker\_version:	0x26 \\
size\_of\_code:	0x6e00 \\
size\_of\_initialized\_data:	0x9c00 \\
size\_of\_uninitialized\_data:	0xc00 \\
address\_of\_entry\_point:	0x14d0 \\
base\_of\_code:	0x1000 \\
base\_of\_data:	0x40000000 \\
image\_base:	0x1 \\
section\_alignment:	0x1000 \\
file\_alignment:	0x200 \\
major\_operating\_system\_version:	0x4 \\
minor\_operating\_system\_version:	0x0 \\
major\_image\_version:	0x0 \\
minor\_image\_version:	0x0 \\
major\_subsystem\_version:	0x5 \\
minor\_subsystem\_version:	0x2 \\
win32\_version\_value:	0x0 \\
size\_of\_image:	0x4e000 \\
size\_of\_headers:	0x600 \\
check\_sum:	0x4f778 \\
subsystem:	0x3 \\
dll\_characteristics:	0x160 \\
size\_of\_stack\_reserve:	0x200000 \\
size\_of\_stack\_commit:	0x1000 \\
size\_of\_heap\_reserve:	0x100000 \\
size\_of\_heap\_commit:	0x1000 \\
loader\_flags:	0x0 \\
number\_of\_rva\_and\_sizes:	0x10 \\
\_data\_directory:	0x0 \\
--- section --- \\
name:	.text \\
virtual\_address:	0x6da80000 \\
size\_of\_raw\_data:	0x6e000000 \\
pointer\_to\_raw\_data:	0x0 \\
pointer\_to\_relocations:	0x0 \\
pointer\_to\_linenumbers:	0x642e6000 \\
number\_of\_relocations:	0x0 \\
number\_of\_linenumbers:	0x0 \\
characteristics:	0x2000000 \\
 \\
/* 中略 */ \\
 \\
--- section --- \\
name:	 .reloc \\
virtual\_address:	0x840000 \\
size\_of\_raw\_data:	0x2000001 \\
pointer\_to\_raw\_data:	0x0 \\
pointer\_to\_relocations:	0x0 \\
pointer\_to\_linenumbers:	0x312f4200 \\
number\_of\_relocations:	0x0 \\
number\_of\_linenumbers:	0x0 \\
characteristics:	0x800000 \\
\end{quote}

\end{document}
